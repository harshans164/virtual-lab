<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pre-Lab Quiz</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root{
            --glass-bg: rgba(255,255,255,0.06);
            --accent: #00ff88;
            --accent-dark: #00a1ff;
            --card-radius: 14px;
            --muted: rgba(255,255,255,0.7);
        }
        body { background: radial-gradient(circle at 10% 10%, rgba(0,161,255,0.08), transparent 10%), linear-gradient(45deg,#071028 0%,#0b1a2e 100%); color: #fff; min-height: 100vh; display:flex; align-items:center; justify-content:center; margin:0; font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; }
        .card { width: 900px; max-width: 95%; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius: var(--card-radius); box-shadow: 0 8px 30px rgba(2,6,23,0.6); backdrop-filter: blur(8px); border: 1px solid rgba(255,255,255,0.04); }
        h2 { color: #e6fef0; margin-bottom: 0.5rem; }
        .meta { color: var(--muted); font-size: 0.95rem; margin-bottom: 1rem; }
        .question { margin-bottom: 1.25rem; padding: 12px; border-radius: 10px; background: rgba(255,255,255,0.01); }
        .question p { margin-bottom: 0.5rem; font-weight: 600; }
        .options { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .option { padding: 10px 12px; border-radius: 10px; background: var(--glass-bg); border: 1px solid rgba(255,255,255,0.03); cursor: pointer; transition: transform .15s ease, box-shadow .15s ease, background .15s ease; display:flex; align-items:center; gap:8px; }
        .option:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,0,0,0.45); }
        .option input { pointer-events: none; }
        .option.selected { background: linear-gradient(90deg, rgba(0,255,136,0.08), rgba(0,161,255,0.06)); border-color: rgba(0,255,136,0.25); box-shadow: 0 6px 18px rgba(0,161,255,0.05) inset; }
        .form-check-label { color: darkgray; }
        .option.selected .form-check-label { color: #e6fef0; }
        .controls { margin-top: 14px; display:flex; justify-content:space-between; align-items:center; }
        .btn-primary { background: linear-gradient(90deg,var(--accent),var(--accent-dark)); border: none; color: #052018; font-weight: 600; padding: 10px 16px; border-radius: 10px; }
        .btn-secondary { border-radius: 10px; }
        #resultCard { border-radius: 10px; background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01)); border: 1px solid rgba(255,255,255,0.03); }
        .result h3 { margin: 0 0 6px 0; }
        .enter-lab { background: linear-gradient(90deg, var(--accent), var(--accent-dark)); border: none; color: #042018; font-weight:700; padding:10px 16px; border-radius:10px; }
        .progress-wrap { width: 100%; height: 10px; background: rgba(255,255,255,0.03); border-radius: 20px; overflow:hidden; margin-bottom: 12px; }
        .progress-bar { height: 100%; width: 0%; background: linear-gradient(90deg,var(--accent),var(--accent-dark)); transition: width .25s ease; }
        @media (max-width:700px){ .options { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="card p-4">
        <h2 class="mb-3">Pre-Lab Quiz</h2>
        <form id="quizForm">
            <div class="question">
                <p style="color: aliceblue;"> 1. Which instrument is used to measure the diameter of the balls? </p>
                <div class="options">
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q1" id="q1a" value="A" >
                        <label class="form-check-label" for="q1a">A) Micrometer</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q1" id="q1b" value="B">
                        <label class="form-check-label" for="q1b">B) Vernier caliper</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q1" id="q1c" value="C">
                        <label class="form-check-label" for="q1c">C) Dial gauge</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q1" id="q1d" value="D">
                        <label class="form-check-label" for="q1d">D) Protractor</label>
                    </div>
                </div>
            </div>

            <hr>

            <div class="question">
                <p style="color:aliceblue;"> 2. Which instrument is used to measure the height of the ball placed inside the taper? </p>
                 <div class="options">
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q2" id="q2a" value="A">
                        <label class="form-check-label" for="q2a">A) Height gauge</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q2" id="q2b" value="B">
                        <label class="form-check-label" for="q2b">B) Vernier caliper</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q2" id="q2c" value="C">
                        <label class="form-check-label" for="q2c">C) Dial indicator</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q2" id="q2d" value="D">
                        <label class="form-check-label" for="q2d">D) Bore gauge</label>
                    </div>
                </div>
            </div>

            <hr>

            <div class="question">
                <p style="color:aliceblue;"> 3. Why are two balls of different diameters used in the experiment? </p>
                <div class="options">
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q3" id="q3a" value="A">
                        <label class="form-check-label" for="q3a">A) To find the taper length directly</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q3" id="q3b" value="B">
                        <label class="form-check-label" for="q3b">B) To determine the difference in heights and calculate the taper angle</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q3" id="q3c" value="C">
                        <label class="form-check-label" for="q3c">C) To check the least count of the instrument</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q3" id="q3d" value="D">
                        <label class="form-check-label" for="q3d">D) To compare material hardness</label>
                    </div>
                </div>
            </div>

            <hr>

            <div class="question">
                <p style="color:aliceblue;"> 4. The difference in height readings between the two balls helps to find: </p>
                <div class="options">
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q4" id="q4a" value="A">
                        <label class="form-check-label" for="q4a">A) The depth of the hole</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q4" id="q4b" value="B">
                        <label class="form-check-label" for="q4b">B) The internal taper angle</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q4" id="q4c" value="C">
                        <label class="form-check-label" for="q4c">C) The diameter of the larger ball</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q4" id="q4d" value="D">
                        <label class="form-check-label" for="q4d">D) The area of the taper</label>
                    </div>
                </div>
            </div>

            <hr>

            <div class="question">
                <p style="color:aliceblue;"> 5. The least count of the height gauge represents: </p>
                <div class="options">
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q5" id="q5a" value="A">
                        <label class="form-check-label" for="q5a">A) The minimum measurable length by the instrument</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q5" id="q5b" value="B">
                        <label class="form-check-label" for="q5b">B) The total height of the instrument</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q5" id="q5c" value="C">
                        <label class="form-check-label" for="q5c">C) The diameter of the ball</label>
                    </div>
                    <div class="option">
                        <input class="form-check-input" type="radio" name="q5" id="q5d" value="D">
                        <label class="form-check-label" for="q5d">D) The range of the taper</label>
                    </div>
                </div>
            </div>

            <div class="mt-3 d-flex justify-content-between">
                <button type="button" id="submitBtn" class="btn btn-primary">Submit Quiz</button>
                <a href="landing.html" class="btn btn-secondary">Back</a>
            </div>
        </form>

        <div id="resultCard" class="mt-4" style="display:none;">
            <div class="result p-3">
                <h3 id="scoreText" style="color:darkgray;"></h3>
                <p id="detailText" style="color:darkgray;"></p>
                <button id="enterLabBtn" class="btn enter-lab">Enter Lab</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        (function(){
            const answers = { q1: 'B', q2: 'A', q3: 'B', q4: 'B', q5: 'A' };
            const submitBtn = document.getElementById('submitBtn');
            const resultCard = document.getElementById('resultCard');
            const scoreText = document.getElementById('scoreText');
            const detailText = document.getElementById('detailText');
            const enterLabBtn = document.getElementById('enterLabBtn');
            const progressBar = document.createElement('div');
            progressBar.className = 'progress-bar';
            const progressWrap = document.createElement('div');
            progressWrap.className = 'progress-wrap';
            progressWrap.appendChild(progressBar);
            const card = document.querySelector('.card');
            card.insertBefore(progressWrap, card.querySelector('form'));

            const questionKeys = Object.keys(answers);

            function grade() {
                let score = 0;
                const total = questionKeys.length;
                const wrong = [];

                for (const q of questionKeys) {
                    const el = document.querySelector(`input[name="${q}"]:checked`);
                    const value = el ? el.value : null;
                    if (value === answers[q]) score++;
                    else wrong.push({ q, got: value, want: answers[q] });
                }

                return { score, total, wrong };
            }

            // highlight option card when radio selected and update progress
            function bindOptions() {
                const allOptions = Array.from(document.querySelectorAll('.option'));
                allOptions.forEach(opt => {
                    opt.addEventListener('click', () => {
                        const input = opt.querySelector('input[type=radio]');
                        if (input) input.checked = true;
                        
                        // Manually trigger change event for other listeners
                        const changeEvent = new Event('change', { bubbles: true });
                        input.dispatchEvent(changeEvent);
                    });
                });

                // also bind direct radio changes (keyboard)
                const radios = Array.from(document.querySelectorAll('input[type=radio]'));
                radios.forEach(r => r.addEventListener('change', () => {
                    updateSelectionStyles();
                    updateProgress();
                }));
            }

            function updateSelectionStyles() {
                // find the option container for the radio that changed
                const groups = document.querySelectorAll('.options');
                groups.forEach(group => {
                    const opts = group.querySelectorAll('.option');
                    opts.forEach(o => {
                        const inp = o.querySelector('input[type=radio]');
                        if (inp && inp.checked) o.classList.add('selected');
                        else o.classList.remove('selected');
                    });
                });
            }

            function updateProgress(){
                const answered = questionKeys.reduce((acc, q) => acc + (document.querySelector(`input[name="${q}"]:checked`) ? 1 : 0), 0);
                const pct = Math.round((answered / questionKeys.length) * 100);
                progressBar.style.width = pct + '%';
            }

            bindOptions();
            updateProgress();

            submitBtn.addEventListener('click', function(){
                const res = grade();
                scoreText.textContent = `You scored ${res.score} out of ${res.total}`;

                if (res.wrong.length === 0) {
                    detailText.textContent = 'Great! All answers are correct.';
                } else {
                    detailText.innerHTML = 'Review: ' + res.wrong.map(w => {
                        const qnum = w.q.replace('q','');
                        return `Question ${qnum}: correct answer is ${w.want}`;
                    }).join('<br>');
                }

                // Show result and the enter lab button
                resultCard.style.display = '';
                // Optionally disable the form to prevent resubmission
                document.getElementById('quizForm').querySelectorAll('input, .option').forEach(i => {
                    i.disabled = true;
                    i.style.pointerEvents = 'none';
                });
                submitBtn.disabled = true;
            });

            enterLabBtn.addEventListener('click', function(){
                window.location.href = 'lab.html';
            });
        })();
    </script>
</body>
</html>